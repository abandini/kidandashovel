# Project: A Kid and a Shovel

**Started:** 2025-01-28
**Repository:** https://github.com/abandini/kidandashovel
**Status:** IN PROGRESS

---

## Overview

A hyperlocal marketplace connecting Northeast Ohio seniors and homeowners with verified teenage workers for snow removal services. Think "Uber meets neighborhood kid economy" with built-in financial literacy features.

### Tech Stack
- Frontend: Server-rendered HTML with Tailwind CSS (mobile-first, senior-friendly)
- Backend: Cloudflare Workers (TypeScript)
- Database: Cloudflare D1 (SQLite)
- Storage: Cloudflare R2 (photos)
- Cache/Sessions: Cloudflare KV
- AI: Cloudflare Workers AI (image moderation)
- Rate Limiting: Cloudflare Durable Objects
- Payments: Stripe Connect
- Deployment: Wrangler CLI / GitHub Actions

### Architecture Decisions
- **Cloudflare Workers (not Pages)**: Need full control over routing, cron triggers, Durable Objects
- **Server-rendered HTML**: Better for seniors, simpler than SPA, works offline with service worker caching
- **D1 for database**: Relational data model (users, jobs, ratings), SQL queries, no external DB dependency
- **R2 for photos**: Before/after job photos, profile photos - binary storage integrated with Workers
- **KV for sessions**: Fast session lookups, TTL support for expiration
- **Durable Objects for rate limiting**: Stateful rate limiting for notifications across worker instances

---

## Key Files Reference

| File | Purpose |
|------|---------|
| `feature-list.json` | Feature tracking and status (63 features) |
| `init.sh` | Environment setup script |
| `wrangler.toml` | Cloudflare Workers configuration |
| `src/index.ts` | Main entry point and router |
| `src/db/migrations/` | D1 database migrations |
| `src/routes/` | API and page route handlers |
| `src/services/` | Business logic services |
| `public/` | Static assets, PWA manifest, service worker |

---

## Session Log

---

### Session: 2025-01-28 (Session 1)

**Agent:** Claude Opus 4.5
**Duration:** ~45 minutes
**Feature(s) Worked On:** infra-001, infra-002, infra-003, infra-004, infra-005

#### Work Completed
- Read project specification document (akidandashovel-spec.md)
- Created feature-list.json with 63 granular testable features
- Created claude-progress.txt for progress tracking
- Created init.sh environment setup script
- Set up complete Cloudflare Workers project structure:
  - package.json with Hono, TypeScript, Wrangler dependencies
  - tsconfig.json configured for Workers
  - wrangler.toml with all bindings
- Created Cloudflare resources:
  - D1 database: akidandashovel-db (id: 1f9ed716-f0a0-41be-b251-e23078c7c886)
  - R2 bucket: akidandashovel-photos
  - KV namespaces: SESSIONS, CACHE
- Created database schema migration (0001_initial.sql) with 15 tables
- Built project structure:
  - src/index.ts - Main entry with Hono router
  - src/types/index.ts - TypeScript types for all entities
  - src/routes/api/*.ts - API route handlers (auth, jobs, workers, ratings, photos)
  - src/routes/pages/*.ts - Page route handlers with landing page
  - src/middleware/*.ts - Auth and validation middleware
  - src/utils/*.ts - Geo calculations, validation, helpers
  - src/durable-objects/rate-limiter.ts - Notification rate limiting
- Verified TypeScript compilation passes
- Applied D1 migrations locally (38 commands executed)
- Pushed initial commit to GitHub

#### Technical Decisions
- **Decision:** Using Hono framework for routing
  - **Why:** Lightweight, built for edge/Workers, good TypeScript support, JSX for templates
  - **Alternatives considered:** itty-router (simpler but fewer features), custom router
- **Decision:** Server-rendered HTML with inline CSS (no Tailwind build)
  - **Why:** Senior users, simpler build, no CSS framework dependency
  - **Alternatives considered:** Tailwind with build step, CSS-in-JS
- **Decision:** SHA-256 for password hashing (Web Crypto API)
  - **Why:** Available in Workers, no external dependencies
  - **Note:** Should upgrade to bcrypt/argon2 equivalent for production

#### Feature Status
| Feature | Status | Notes |
|---------|--------|-------|
| infra-001 | PASSED | Wrangler dev starts, TypeScript compiles, all bindings connect |
| infra-002 | PASSED | D1 created, 38 SQL commands executed, 15 tables created |
| infra-003 | PASSED | R2 bucket created, binding verified in dev server |
| infra-004 | PASSED | KV namespaces created, bindings verified |
| infra-005 | PASSED | Hono router handles all routes with CORS middleware |

#### Commits Made
```
6ce3175 feat: initial project setup for A Kid and a Shovel
```

#### Next Session Should
1. **Run `wrangler dev`** to verify the dev server starts and routing works
2. **Test infrastructure** - verify D1 queries, R2 uploads, KV read/write
3. **Mark infra features as PASSED** once verified
4. **Begin core-001** - Homeowner registration implementation
5. **Deploy to production** once local testing passes

#### Environment State
- [ ] All tests passing (no tests written yet)
- [x] Dev server runs without errors
- [x] No uncommitted changes
- [x] Database migrations applied (locally)
- [x] Environment variables configured (.dev.vars created)

#### Blockers
- None - infrastructure complete, ready to implement core features

---

## Notes

**MVP Focus:** The spec has 4 phases, but we're focusing on Phase 1 (MVP) first:
- User registration (homeowner, teen, parent consent)
- Job posting and lifecycle
- Before/after photo system
- Basic rating system
- Cash payment marking
- NEO geographic restriction

Phase 2 (Stripe payments, push notifications, weather integration) will come after MVP is complete.
